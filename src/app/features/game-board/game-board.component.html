<div class="game-board">
  <div class="game-board__container">
    <!-- Scoreboard -->
    <aside class="game-board__sidebar">
      <app-scoreboard [players]="gameState().players" [currentPlayerIndex]="gameState().currentPlayerIndex"
        [deckCount]="deckCount()" [phase]="gameState().phase" [isFinalRound]="isFinalRound()"></app-scoreboard>
    </aside>

    <!-- Main Game Area -->
    <main class="game-board__main">
      <!-- Phase Instruction -->
      <div class="game-board__instruction" *ngIf="phaseInstruction">
        <p>{{ phaseInstruction }}</p>
      </div>

      <!-- Toast Notifications -->
      <app-toast></app-toast>

      <!-- Player Tableau -->
      <div class="game-board__tableau">
        <app-player-tableau [player]="currentPlayer()" [selectedCards]="selectedCards()"
          [highlightedCards]="selectedMatch()?.cards || []"
          [disabled]="isCurrentPlayerBot || !canRollDice() || rolling()"></app-player-tableau>
      </div>

      <!-- Dice Roller -->
      <div class="game-board__dice">
        <app-dice-roller [diceRoll]="gameState().lastDiceRoll" [canRoll]="canRollDice() && !isCurrentPlayerBot"
          [rolling]="rolling()" (rollDice)="onRollDice()"></app-dice-roller>
      </div>

      <!-- Match Selector -->
      <div class="game-board__matches">
        <app-match-selector [matches]="possibleMatches()"
          [canMatch]="gameState().phase === 'matching' && !isCurrentPlayerBot" [selectedMatch]="selectedMatch()"
          (matchSelected)="onMatchSelected($event)" (drawCard)="onDrawCard()"
          (confirmMatch)="onConfirmMatch($event)"></app-match-selector>
      </div>
    </main>
  </div>

  <!-- Game Over Modal -->
  <app-game-over *ngIf="isGameOver()" [players]="gameState().players" [winner]="gameState().winner"
    (newGame)="onNewGame()" (backToSetup)="onBackToSetup()"></app-game-over>
</div>